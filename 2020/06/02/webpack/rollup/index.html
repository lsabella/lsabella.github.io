<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Baishu"><meta name="copyright" content="Baishu"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>Rollup æ‰“åŒ…å‘å¸ƒ | Baishuçš„åšå®¢</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"ç™½èˆ’å°ç«™","version":"1.6.2","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><meta name="description" content="Rollupç”¨æ¥å¹²å•¥Rollupæ˜¯å½“å‰æµè¡Œçš„åº“æ‰“åŒ…å™¨ï¼Œåœ¨Webpackã€ESMï¼ˆES6æ¨¡å—ï¼‰ä¹‹åå‡ºç°ï¼ŒRollupæ”¯æŒå¼€å‘è€…ä½¿ç”¨ESMæ¨¡å—è¯­æ³•å¼€å‘ã€‚ æ–‡ä»¶ç±»å‹å‡ ä¹åªæ”¯æŒJSï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶å¦‚CSSç­‰å‡éœ€è¦ä½¿ç”¨æ’ä»¶å¤„ç†ï¼ˆåç»­ä¼šä»‹ç» ï¼‰ ç‰¹ç‚¹ Rollupå°†ä»£ç è½¬ç æˆç›®æ ‡jsï¼ˆæ”¯æŒumd&#x2F;commonjs&#x2F;esï¼‰  Rollupæ¨å´‡ESMæ¨¡å—æ ‡å‡†å¼€å‘ï¼ˆå€ŸåŠ©æµè§ˆå™¨å¯¹ESMçš„æ”¯æŒï¼‰  Rollupæ‰“åŒ…äº§ç‰©">
<meta property="og:type" content="article">
<meta property="og:title" content="Rollup æ‰“åŒ…å‘å¸ƒ">
<meta property="og:url" content="http://example.com/2020/06/02/webpack/rollup/index.html">
<meta property="og:site_name" content="Baishuçš„åšå®¢">
<meta property="og:description" content="Rollupç”¨æ¥å¹²å•¥Rollupæ˜¯å½“å‰æµè¡Œçš„åº“æ‰“åŒ…å™¨ï¼Œåœ¨Webpackã€ESMï¼ˆES6æ¨¡å—ï¼‰ä¹‹åå‡ºç°ï¼ŒRollupæ”¯æŒå¼€å‘è€…ä½¿ç”¨ESMæ¨¡å—è¯­æ³•å¼€å‘ã€‚ æ–‡ä»¶ç±»å‹å‡ ä¹åªæ”¯æŒJSï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶å¦‚CSSç­‰å‡éœ€è¦ä½¿ç”¨æ’ä»¶å¤„ç†ï¼ˆåç»­ä¼šä»‹ç» ï¼‰ ç‰¹ç‚¹ Rollupå°†ä»£ç è½¬ç æˆç›®æ ‡jsï¼ˆæ”¯æŒumd&#x2F;commonjs&#x2F;esï¼‰  Rollupæ¨å´‡ESMæ¨¡å—æ ‡å‡†å¼€å‘ï¼ˆå€ŸåŠ©æµè§ˆå™¨å¯¹ESMçš„æ”¯æŒï¼‰  Rollupæ‰“åŒ…äº§ç‰©">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/webpack/webpack_compare.png">
<meta property="og:image" content="http://example.com/images/webpack/rollup_compare.png">
<meta property="og:image" content="http://example.com/images/webpack/rollup_demo_dist.png">
<meta property="og:image" content="http://example.com/images/webpack/umi_demo.png">
<meta property="og:image" content="http://example.com/images/webpack/publish_manual.png">
<meta property="og:image" content="http://example.com/images/webpack/publish_script.png">
<meta property="og:image" content="http://example.com/images/tips/1.png">
<meta property="og:image" content="http://example.com/images/webpack/babel_build.png">
<meta property="og:image" content="http://example.com/images/webpack/loadsh_in.png">
<meta property="og:image" content="http://example.com/images/webpack/terser.png">
<meta property="og:image" content="http://example.com/images/webpack/run_dev.png">
<meta property="og:image" content="http://example.com/images/webpack/paths.png">
<meta property="article:published_time" content="2020-06-02T10:32:10.000Z">
<meta property="article:modified_time" content="2020-06-02T15:12:36.000Z">
<meta property="article:author" content="Baishu">
<meta property="article:tag" content="æ‰“åŒ…">
<meta property="article:tag" content="Rollup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/webpack/webpack_compare.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Baishu"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="Baishu"><span class="site-author-status" title="Looking for dawn.">â›½ï¸</span></a><div class="site-author-name"><a href="/about/">Baishu</a></div><a class="site-name" href="/about/site.html">Baishuçš„åšå®¢</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">21</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">9</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">18</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="æ–‡æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/lsabella" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:baishu1024@gmail.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Rollup%E7%94%A8%E6%9D%A5%E5%B9%B2%E5%95%A5"><span class="toc-number">1.</span> <span class="toc-text">Rollupç”¨æ¥å¹²å•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text">æ–‡ä»¶ç±»å‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">ç‰¹ç‚¹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F0-gt-1"><span class="toc-number">2.</span> <span class="toc-text">å¿«é€Ÿ0 -&gt; 1</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-number">2.1.</span> <span class="toc-text">æ–°å»ºå·¥ç¨‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85rollup"><span class="toc-number">2.2.</span> <span class="toc-text">å®‰è£…rollup</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%9F%E6%88%90tsconfig-json%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">ç”Ÿæˆtsconfig.jsoné…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BArollup-config-js"><span class="toc-number">2.4.</span> <span class="toc-text">åˆ›å»ºrollup.config.js</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E9%9C%80%E6%89%93%E5%8C%85%E5%BA%93%E6%BA%90%E7%A0%81"><span class="toc-number">2.5.</span> <span class="toc-text">ç¼–å†™éœ€æ‰“åŒ…åº“æºç </span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E7%BC%96%E5%86%99"><span class="toc-number">2.5.1.</span> <span class="toc-text">æºç ç¼–å†™</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA"><span class="toc-number">2.5.2.</span> <span class="toc-text">æ‰“åŒ…æ„å»º</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E4%BD%BF%E7%94%A8"><span class="toc-number">2.5.3.</span> <span class="toc-text">å¼•å…¥ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%8F%91%E5%B8%83%E8%84%9A%E6%9C%AC"><span class="toc-number">2.6.</span> <span class="toc-text">æ„å»ºå‘å¸ƒè„šæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6"><span class="toc-number">2.6.1.</span> <span class="toc-text">æ‹·è´æ–‡ä»¶</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6"><span class="toc-number">2.6.2.</span> <span class="toc-text">ä¿®æ”¹æ–‡ä»¶</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%91%E5%B8%83"><span class="toc-number">2.6.3.</span> <span class="toc-text">å‘å¸ƒ</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.7.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">å¸¸ç”¨é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#input"><span class="toc-number">3.1.</span> <span class="toc-text">input</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#output"><span class="toc-number">3.2.</span> <span class="toc-text">output</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#plugins"><span class="toc-number">3.3.</span> <span class="toc-text">plugins</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#external"><span class="toc-number">3.4.</span> <span class="toc-text">external</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#global"><span class="toc-number">3.5.</span> <span class="toc-text">global</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%B1%E5%85%A5%E4%BD%BF%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">æ·±å…¥ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Babel"><span class="toc-number">4.1.</span> <span class="toc-text">ä½¿ç”¨Babel</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#node%E6%A8%A1%E5%9D%97%E7%9A%84%E5%BC%95%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">nodeæ¨¡å—çš„å¼•ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%89%E6%96%B9%E5%BA%93lodash"><span class="toc-number">4.2.1.</span> <span class="toc-text">ä½¿ç”¨ä¸‰æ–¹åº“lodash</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8typescript"><span class="toc-number">4.3.</span> <span class="toc-text">ä½¿ç”¨typescript</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E4%BB%A3%E7%A0%81"><span class="toc-number">4.4.</span> <span class="toc-text">å‹ç¼©ä»£ç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E8%AF%91css"><span class="toc-number">4.5.</span> <span class="toc-text">ç¼–è¯‘css</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%BA%E5%88%86%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%92%8C%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83"><span class="toc-number">4.6.</span> <span class="toc-text">åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E6%9C%AC%E5%9C%B0%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.7.</span> <span class="toc-text">å¼€å¯æœ¬åœ°æœåŠ¡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E7%83%AD%E6%9B%B4%E6%96%B0"><span class="toc-number">4.8.</span> <span class="toc-text">å¼€å¯çƒ­æ›´æ–°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E6%96%87%E4%BB%B6"><span class="toc-number">4.9.</span> <span class="toc-text">å¤šä¸ªè¾“å…¥è¾“å‡ºæ–‡ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E6%8F%92%E4%BB%B6"><span class="toc-number">4.10.</span> <span class="toc-text">æ›´å¤šæ’ä»¶</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2020/06/02/webpack/rollup/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Baishu"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Baishuçš„åšå®¢"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Rollup æ‰“åŒ…å‘å¸ƒ</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2020-06-02 18:32:10" itemprop="dateCreated datePublished" datetime="2020-06-02T18:32:10+08:00">2020-06-02</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/Rollup/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">Rollup</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/%E6%89%93%E5%8C%85/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">æ‰“åŒ…</span></a><a class="tag-item" href="/tags/Rollup/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Rollup</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h4 id="Rollupç”¨æ¥å¹²å•¥"><a href="#Rollupç”¨æ¥å¹²å•¥" class="headerlink" title="Rollupç”¨æ¥å¹²å•¥"></a>Rollupç”¨æ¥å¹²å•¥</h4><p>Rollupæ˜¯å½“å‰æµè¡Œçš„åº“æ‰“åŒ…å™¨ï¼Œåœ¨Webpackã€ESMï¼ˆES6æ¨¡å—ï¼‰ä¹‹åå‡ºç°ï¼ŒRollupæ”¯æŒå¼€å‘è€…ä½¿ç”¨ESMæ¨¡å—è¯­æ³•å¼€å‘ã€‚</p>
<h5 id="æ–‡ä»¶ç±»å‹"><a href="#æ–‡ä»¶ç±»å‹" class="headerlink" title="æ–‡ä»¶ç±»å‹"></a>æ–‡ä»¶ç±»å‹</h5><p>å‡ ä¹åªæ”¯æŒJSï¼Œå…¶ä»–ç±»å‹çš„æ–‡ä»¶å¦‚CSSç­‰å‡éœ€è¦ä½¿ç”¨æ’ä»¶å¤„ç†ï¼ˆåç»­ä¼šä»‹ç» ï¼‰</p>
<h5 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h5><ol>
<li><p>Rollupå°†ä»£ç è½¬ç æˆç›®æ ‡jsï¼ˆæ”¯æŒumd/commonjs/esï¼‰</p>
</li>
<li><p>Rollupæ¨å´‡ESMæ¨¡å—æ ‡å‡†å¼€å‘ï¼ˆå€ŸåŠ©æµè§ˆå™¨å¯¹ESMçš„æ”¯æŒï¼‰</p>
</li>
<li><p>Rollupæ‰“åŒ…äº§ç‰©å¯¹æ¯”Webpackè¾ƒä¸ºç²¾ç®€ï¼Œå¦‚ä¸‹<br>webpack:<br><img src="/images/webpack/webpack_compare.png" alt="webpack_compare" loading="lazy"></p>
<pre><code> 1. æœ‰å¤§é‡çš„è¯¸å¦‚ __webpack_require__ä¹‹ç±»çš„ä»£ç ï¼Œè¿™äº›éƒ½æ˜¯ Webpack è‡ªèº« Polyfill çš„åœ¨è¿è¡Œæ—¶çš„æ¨¡å—åŠ è½½ï¼Œ
 å°±æ˜¯ä¸ºäº†è®©äº§ç‰©ä»£ç åœ¨æ‰€æœ‰æµè§ˆå™¨éƒ½èƒ½è¿è¡Œï¼ˆwepackå‡ºç°çš„æ—¶å€™è¿˜æ²¡æœ‰ESM ï¼Œå½“æ—¶çš„æ¨¡å—æ ‡å‡†è¿˜å¾ˆæ··ä¹±ï¼ŒWebpackæŠ¹å¹³äº†å·®å¼‚ã€‚ï¼‰
 2. ç”¨ IIFE å®ç°æ¨¡å—ä¹‹é—´çš„éš”ç¦»ï¼Œå¹¶ä¸”ç”¨__webpack_require__ __webpack_exports__ ç­‰ Polyfill å®ç°åœ¨æµè§ˆå™¨ç¯å¢ƒé‡Œæ¨¡æ‹Ÿ CJS æ¨¡å—åŠ è½½
 3. ç”¨ Webpack æ‰“åŒ…åçš„ä»£ç å®é™…ä¸Šæ›´åƒæ˜¯è·‘åœ¨ Webpack ç»™æˆ‘ä»¬å®ç°çš„â€œè™šæ‹Ÿ Runtimeâ€ä¸Š
</code></pre>
</li>
</ol>
<p>Rollup:<br><img src="/images/webpack/rollup_compare.png" alt="rollup_compare" loading="lazy"></p>
<pre><code>    Rollup è¯ç”Ÿåœ¨ ESM æ¨¡å—æ ‡å‡†å‡ºæ¥ä¹‹åï¼Œæ‰€ä»¥ Rollup å®Œå…¨éµä» ESM æ ‡å‡†ï¼Œä¸éœ€è¦åƒ Webpack é‚£æ ·åšå¾ˆå¤š Runtime Polyfillï¼Œ
    å®Œå…¨æŠŠä»£ç äº¤ç»™æµè§ˆå™¨è¿è¡Œã€‚å¯¹äºä¸€äº›é¡¹ç›®é‡Œä¾èµ–çš„è€æ—§çš„ CJS çš„åŒ…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ’ä»¶æ¥å¯¹è¿™äº›ä¾èµ–å¤„ç†ã€‚
</code></pre>
<h4 id="å¿«é€Ÿ0-gt-1"><a href="#å¿«é€Ÿ0-gt-1" class="headerlink" title="å¿«é€Ÿ0 -&gt; 1"></a>å¿«é€Ÿ0 -&gt; 1</h4><h5 id="æ–°å»ºå·¥ç¨‹"><a href="#æ–°å»ºå·¥ç¨‹" class="headerlink" title="æ–°å»ºå·¥ç¨‹"></a>æ–°å»ºå·¥ç¨‹</h5><p>åˆ›å»ºç©ºæ–‡ä»¶å¤¹ï¼Œå¦‚ mkdir proton-utils</p>
<h5 id="å®‰è£…rollup"><a href="#å®‰è£…rollup" class="headerlink" title="å®‰è£…rollup"></a>å®‰è£…rollup</h5><p>cd proton-utils &amp; code .</p>
<p>npm init -y</p>
<p>npm install rollup â€“save-dev</p>
<p>touch .gitignore &amp; vim .gitignore</p>
<p>/node_modules</p>
<h5 id="ç”Ÿæˆtsconfig-jsoné…ç½®æ–‡ä»¶"><a href="#ç”Ÿæˆtsconfig-jsoné…ç½®æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆtsconfig.jsoné…ç½®æ–‡ä»¶"></a>ç”Ÿæˆtsconfig.jsoné…ç½®æ–‡ä»¶</h5><p>tsc â€“init<br>é»˜è®¤çš„é…ç½®å…¶å®å·²ç»å¤Ÿç”¨ï¼Œåç»­å¯ä»¥æ ¹æ®éœ€è¦åˆ å‡é…ç½®ã€‚</p>
<pre><code>    &#123;
    &quot;compilerOptions&quot;: &#123;
        &quot;target&quot;: &quot;es2016&quot;,                                  /* Set the JavaScript language version for emitted JavaScript and include compatible library declarations. */
        /* Modules */
        &quot;module&quot;: &quot;commonjs&quot;,                                /* Specify what module code is generated. */
        /* Interop Constraints */
        &quot;esModuleInterop&quot;: true,                             /* Emit additional JavaScript to ease support for importing CommonJS modules. This enables `allowSyntheticDefaultImports` for type compatibility. */
        &quot;forceConsistentCasingInFileNames&quot;: true,            /* Ensure that casing is correct in imports. */
        /* Type Checking */
        &quot;strict&quot;: true,                                      /* Enable all strict type-checking options. */
        &quot;skipLibCheck&quot;: true                                 /* Skip type checking all .d.ts files. */
    &#125;
    &#125;
</code></pre>
<h5 id="åˆ›å»ºrollup-config-js"><a href="#åˆ›å»ºrollup-config-js" class="headerlink" title="åˆ›å»ºrollup.config.js"></a>åˆ›å»ºrollup.config.js</h5><p>touch rollup.config.js</p>
<p><a target="_blank" rel="noopener" href="https://rollupjs.org/guide/en/#big-list-of-options">Rollupæ–‡ä»¶é…ç½®é¡¹</a><br><a target="_blank" rel="noopener" href="https://github.com/rollup/plugins">Rollupæ’ä»¶åˆ—è¡¨</a></p>
<pre><code>    import resolve from &#39;rollup-plugin-node-resolve&#39;;
    import commonjs from &#39;rollup-plugin-commonjs&#39;;
    import typescript from &#39;rollup-plugin-typescript&#39;;
    import pkg from &#39;./package.json&#39;;

    export default &#123;
    input: &#39;src/index.ts&#39;, // æ‰“åŒ…å…¥å£
    output: &#123; // æ‰“åŒ…å‡ºå£
        file: pkg.browser, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: &#39;dist/index.js&#39;å­—æ®µä¸­é…ç½®çš„
        format: &#39;umd&#39;, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨
        name:&#39;proton-utils&#39; // åŒ…çš„å…¨å±€å˜é‡åç§°
    &#125;,
    plugins: [ // æ‰“åŒ…æ’ä»¶
        resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—
        commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†
        typescript() // è§£æTypeScript
    ]
    &#125;;
</code></pre>
<p>vim package.json</p>
<pre><code>     &quot;browser&quot;: &quot;dist/index.ts&quot;,
</code></pre>
<p>npm i -D rollup typescript tslib rollup-plugin-node-resolve rollup-plugin-commonjs rollup-plugin-typescript</p>
<ul>
<li>tslibåœ¨rollup.config.jsæ²¡æœ‰å¼•å…¥ï¼Œä¸ºå•¥å®‰è£…ï¼Ÿ -&gt; rollup-plugin-typescriptæ’ä»¶ä¾èµ–äº†è¯¥åº“ã€‚</li>
</ul>
<h5 id="ç¼–å†™éœ€æ‰“åŒ…åº“æºç "><a href="#ç¼–å†™éœ€æ‰“åŒ…åº“æºç " class="headerlink" title="ç¼–å†™éœ€æ‰“åŒ…åº“æºç "></a>ç¼–å†™éœ€æ‰“åŒ…åº“æºç </h5><p>0 -&gt; 1 å°demo<br>è·‘é€šæºç ç¼–å†™ -&gt; æ‰“åŒ…æ„å»º -&gt; å¼•å…¥ä½¿ç”¨</p>
<h6 id="æºç ç¼–å†™"><a href="#æºç ç¼–å†™" class="headerlink" title="æºç ç¼–å†™"></a>æºç ç¼–å†™</h6><p>mkdir src &amp; touch src/index.ts</p>
<p>vim src/index.ts</p>
<pre><code>    console.log(&#39;baishu test rollup:&#39;)
</code></pre>
<p>:wq</p>
<h6 id="æ‰“åŒ…æ„å»º"><a href="#æ‰“åŒ…æ„å»º" class="headerlink" title="æ‰“åŒ…æ„å»º"></a>æ‰“åŒ…æ„å»º</h6><p>vim package.json</p>
<pre><code>    &quot;scripts&quot;: &#123;
        &quot;build&quot;:&quot;rollup -c&quot;
    &#125;,
</code></pre>
<p>:wq</p>
<p>npm run build<br><img src="/images/webpack/rollup_demo_dist.png" alt="rollup_demo_dist" loading="lazy"></p>
<p>æ‰‹åŠ¨å‘å¸ƒï¼š npm publish </p>
<ul>
<li><a href="mailto:&#98;&#97;&#x69;&#x73;&#x68;&#x75;&#x2d;&#x70;&#x72;&#x6f;&#116;&#x6f;&#110;&#x2d;&#x75;&#116;&#x69;&#x6c;&#115;&#64;&#x31;&#x2e;&#x30;&#x2e;&#49;">&#98;&#97;&#x69;&#x73;&#x68;&#x75;&#x2d;&#x70;&#x72;&#x6f;&#116;&#x6f;&#110;&#x2d;&#x75;&#116;&#x69;&#x6c;&#115;&#64;&#x31;&#x2e;&#x30;&#x2e;&#49;</a></li>
</ul>
<h6 id="å¼•å…¥ä½¿ç”¨"><a href="#å¼•å…¥ä½¿ç”¨" class="headerlink" title="å¼•å…¥ä½¿ç”¨"></a>å¼•å…¥ä½¿ç”¨</h6><p>mkdir web_app &amp; cd web_app &amp; yarn create @umijs/umi-app<br><img src="/images/webpack/umi_demo.png" alt="umi_demo" loading="lazy"></p>
<h5 id="æ„å»ºå‘å¸ƒè„šæœ¬"><a href="#æ„å»ºå‘å¸ƒè„šæœ¬" class="headerlink" title="æ„å»ºå‘å¸ƒè„šæœ¬"></a>æ„å»ºå‘å¸ƒè„šæœ¬</h5><p>åœ¨å®‰è£…ä½¿ç”¨ä¹‹å‰ï¼Œéœ€å°†æ‰“åŒ…æ„å»ºå¥½çš„æ–‡ä»¶å‘å¸ƒè‡³ç±»ä¼¼npmä»“åº“ï¼ˆ verdaccioæ­å»ºç§æœ‰npmä»“åº“åç»­æ–‡ç« ä»‹ç»ï¼‰ï¼Œä¾›é¡¹ç›®å®‰è£…ã€‚<br>ç”±äºä¸Šä¸€ç« èŠ‚åªæ˜¯ä¸€ä¸ªdemoï¼Œåˆ™æ‰‹åŠ¨publishè‡³npmä»“åº“ï¼ˆæºç ä¹Ÿè¢«æ¨ä¸Šå»äº†ï¼Œæ˜¾ç„¶ä¸ç¨³å½“ï¼Œå¦‚ä¸‹å›¾ï¼‰<br><img src="/images/webpack/publish_manual.png" alt="publish_manual" loading="lazy"></p>
<p>è§£å†³é—®é¢˜ï¼š</p>
<pre><code>    1. åªå‘å¸ƒæ‰“åŒ…åæ–‡ä»¶
    2. å‘å¸ƒç‰ˆæœ¬å·è‡ªåŠ¨+1
    3. è„šæœ¬å‘å¸ƒ
</code></pre>
<h6 id="æ‹·è´æ–‡ä»¶"><a href="#æ‹·è´æ–‡ä»¶" class="headerlink" title="æ‹·è´æ–‡ä»¶"></a>æ‹·è´æ–‡ä»¶</h6><p>vim package.json</p>
<pre><code>    &quot;scripts&quot;: &#123;
        ...,
        &quot;copy&quot;: &quot;cp package.json dist&quot;
    &#125;,
</code></pre>
<h6 id="ä¿®æ”¹æ–‡ä»¶"><a href="#ä¿®æ”¹æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶"></a>ä¿®æ”¹æ–‡ä»¶</h6><p>mkdir scripts &amp; cd scripts &amp; touch scripts/publish.js</p>
<p>npm i -D shelljs commander</p>
<p>vim package.json</p>
<pre><code>    &quot;scripts&quot;: &#123;
        ...,
        &quot;copy&quot;: &quot;cp package.json dist&quot;,
        &quot;build&quot;: &quot;rollup -c &amp;&amp; npm run copy&quot;
    &#125;,
</code></pre>
<p>vim scripts/publish.js </p>
<pre><code>    const path = require(&#39;path&#39;);
    const shelljs = require(&#39;shelljs&#39;);
    const program = require(&#39;commander&#39;);

    const targetFile = path.resolve(__dirname, &#39;../dist/package.json&#39;);
    const packagejson = require(targetFile);
    const currentVersion = packagejson.version;
    const versionArr = currentVersion.split(&#39;.&#39;);
    const [mainVersion, subVersion, phaseVersion] = versionArr;

    // é»˜è®¤ç‰ˆæœ¬å·
    const defaultVersion = `$&#123;mainVersion&#125;.$&#123;subVersion&#125;.$&#123;+phaseVersion+1&#125;`;

    let newVersion = defaultVersion;

    // ä»å‘½ä»¤è¡Œå‚æ•°ä¸­å–ç‰ˆæœ¬å·
    program
    .option(&#39;-v, --versions &lt;type&gt;&#39;, &#39;Add release version number&#39;, defaultVersion);

    program.parse(process.argv);

    if (program.versions) &#123;
    newVersion = program.versions;
    &#125;

    function publish() &#123;
    shelljs.sed(&#39;-i&#39;, &#39;&quot;name&quot;: &quot;proton-utils&quot;&#39;, &#39;&quot;name&quot;: &quot;baishu-proton-utils&quot;&#39;, targetFile); // ä¿®æ”¹åŒ…å
    shelljs.sed(&#39;-i&#39;, `&quot;version&quot;: &quot;$&#123;currentVersion&#125;&quot;`, `&quot;version&quot;: &quot;$&#123;newVersion&#125;&quot;`, targetFile); // ä¿®æ”¹ç‰ˆæœ¬å·
    shelljs.cd(&#39;dist&#39;);
    shelljs.exec(&#39;npm publish&#39;); // å‘å¸ƒ
    &#125;

    publish();
</code></pre>
<h6 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h6><p>vim package.json</p>
<pre><code>    &quot;scripts&quot;: &#123;
        &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,
        &quot;copy&quot;: &quot;cp package.json dist&quot;,
        &quot;build&quot;: &quot;rollup -c &amp;&amp; npm run copy&quot;,
        &quot;publish&quot;: &quot;node scripts/publish.js&quot;
    &#125;,
</code></pre>
<p>npm run publish</p>
<h5 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆä»0 -&gt; 1çš„è¿‡ç¨‹</p>
<p>å­¦ä¼šäº†ï¼š<br>1.å¦‚ä½•é…ç½®Rollupå’ŒTypeScript<br>2.è„šæœ¬è‡ªåŠ¨åŒ–å‘å¸ƒå·¥å…·åº“åˆ°npmä»“åº“</p>
<p>å¼•å…¥åŒ…å†…å®¹ï¼ˆä»…æºç  å½’åŠŸäºpublish.jsï¼‰<br><img src="/images/webpack/publish_script.png" alt="publish_script" loading="lazy"></p>
<p>æ¥ä¸‹æ¥ç« èŠ‚ä¸­ï¼Œå°†ä¼šä»”ç»†ä»‹ç»Rollupç›¸å…³å†…å®¹ğŸ˜„</p>
<p><img src="/images/tips/1.png" alt="tip_1" loading="lazy"></p>
<h4 id="å¸¸ç”¨é…ç½®"><a href="#å¸¸ç”¨é…ç½®" class="headerlink" title="å¸¸ç”¨é…ç½®"></a>å¸¸ç”¨é…ç½®</h4><p><a target="_blank" rel="noopener" href="https://rollupjs.org/guide/en/#big-list-of-options">Rollupæ–‡ä»¶é…ç½®é¡¹</a></p>
<h5 id="input"><a href="#input" class="headerlink" title="input"></a>input</h5><p>å…¥å£æ–‡ä»¶åœ°å€</p>
<h5 id="output"><a href="#output" class="headerlink" title="output"></a>output</h5><pre><code>    output:&#123;
        file:&#39;bundle.js&#39;, // è¾“å‡ºæ–‡ä»¶
        format: &#39;cjs,  //  äº”ç§è¾“å‡ºæ ¼å¼ï¼šamd /  es6 / iife / umd / cjs
        name:&#39;A&#39;,  //å½“formatä¸ºiifeå’Œumdæ—¶å¿…é¡»æä¾›ï¼Œå°†ä½œä¸ºå…¨å±€å˜é‡æŒ‚åœ¨window(æµè§ˆå™¨ç¯å¢ƒ)ä¸‹ï¼šwindow.A=...
        sourcemap:true  //ç”Ÿæˆbundle.map.jsæ–‡ä»¶ï¼Œæ–¹ä¾¿è°ƒè¯•
    &#125;
</code></pre>
<h5 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h5><p>å„ç§æ’ä»¶ä½¿ç”¨çš„é…ç½®</p>
<h5 id="external"><a href="#external" class="headerlink" title="external"></a>external</h5><p>external:[â€˜lodashâ€™] //å‘Šè¯‰rollupä¸è¦å°†æ­¤lodashæ‰“åŒ…ï¼Œè€Œä½œä¸ºå¤–éƒ¨ä¾èµ–</p>
<h5 id="global"><a href="#global" class="headerlink" title="global"></a>global</h5><pre><code>    global:&#123;
        &#39;jquery&#39;:&#39;$&#39; //å‘Šè¯‰rollup å…¨å±€å˜é‡$å³æ˜¯jquery
    &#125;
</code></pre>
<p><a target="_blank" rel="noopener" href="https://github.com/reduxjs/react-redux/blob/master/rollup.config.js">react-reduxçš„rollupé…ç½®</a></p>
<pre><code>    import nodeResolve from &#39;rollup-plugin-node-resolve&#39; // å¸®åŠ©å¯»æ‰¾node_modulesé‡Œçš„åŒ…
    import babel from &#39;rollup-plugin-babel&#39; // rollup çš„ babel æ’ä»¶ï¼ŒES6è½¬ES5
    import replace from &#39;rollup-plugin-replace&#39; // æ›¿æ¢å¾…æ‰“åŒ…æ–‡ä»¶é‡Œçš„ä¸€äº›å˜é‡ï¼Œå¦‚processåœ¨æµè§ˆå™¨ç«¯æ˜¯ä¸å­˜åœ¨çš„ï¼Œéœ€è¦è¢«æ›¿æ¢
    import commonjs from &#39;rollup-plugin-commonjs&#39; // å°†éES6è¯­æ³•çš„åŒ…è½¬ä¸ºES6å¯ç”¨
    import uglify from &#39;rollup-plugin-uglify&#39; // å‹ç¼©åŒ…

    const env = process.env.NODE_ENV

    const config = &#123;
    input: &#39;src/index.js&#39;,
    external: [&#39;react&#39;, &#39;redux&#39;], // å‘Šè¯‰rollupï¼Œä¸æ‰“åŒ…react,redux;å°†å…¶è§†ä¸ºå¤–éƒ¨ä¾èµ–
    output: &#123; 
        format: &#39;umd&#39;, // è¾“å‡º ï¼µï¼­ï¼¤æ ¼å¼ï¼Œå„ç§æ¨¡å—è§„èŒƒé€šç”¨
        name: &#39;ReactRedux&#39;, // æ‰“åŒ…åçš„å…¨å±€å˜é‡ï¼Œå¦‚æµè§ˆå™¨ç«¯ window.ReactReduxã€€
        globals: &#123;
        react: &#39;React&#39;, // è¿™è·Ÿexternal æ˜¯é…å¥—ä½¿ç”¨çš„ï¼ŒæŒ‡æ˜global.Reactå³æ˜¯å¤–éƒ¨ä¾èµ–react
        redux: &#39;Redux&#39;
        &#125;
    &#125;,
    plugins: [
        nodeResolve(),
        babel(&#123;
        exclude: &#39;**/node_modules/**&#39;
        &#125;),
        replace(&#123;
        &#39;process.env.NODE_ENV&#39;: JSON.stringify(env)
        &#125;),
        commonjs()
    ]
    &#125;

    if (env === &#39;production&#39;) &#123;
    config.plugins.push(
        uglify(&#123;
        compress: &#123;
            pure_getters: true,
            unsafe: true,
            unsafe_comps: true,
            warnings: false
        &#125;
        &#125;)
    )
    &#125;

    export default config
</code></pre>
<h4 id="æ·±å…¥ä½¿ç”¨"><a href="#æ·±å…¥ä½¿ç”¨" class="headerlink" title="æ·±å…¥ä½¿ç”¨"></a>æ·±å…¥ä½¿ç”¨</h4><h5 id="ä½¿ç”¨Babel"><a href="#ä½¿ç”¨Babel" class="headerlink" title="ä½¿ç”¨Babel"></a>ä½¿ç”¨Babel</h5><blockquote>
<p>ä¸ºäº†æ­£ç¡®è§£ææˆ‘ä»¬çš„æ¨¡å—å¹¶ä½¿å…¶ä¸æ—§ç‰ˆæµè§ˆå™¨å…¼å®¹ï¼Œä½¿ç”¨babelç¼–è¯‘è¾“å‡ºã€‚ä»¥ä¾¿å¯ä»¥ä½¿ç”¨æœªè¢«æµè§ˆå™¨å’Œ Node.js æ”¯æŒçš„å°†æ¥ç‰ˆæœ¬çš„ JavaScriptç‰¹æ€§ã€‚</p>
</blockquote>
<ol>
<li><p>npm install rollup-plugin-babel â€“save-dev</p>
</li>
<li><p>vim rollup.config.js</p>
<pre><code> import babel from &#39;rollup-plugin-babel&#39;
 import resolve from &#39;rollup-plugin-node-resolve&#39;;
 import commonjs from &#39;rollup-plugin-commonjs&#39;;
 import typescript from &#39;rollup-plugin-typescript&#39;;
 import pkg from &#39;./package.json&#39;;

 const extensions = [&#39;.js&#39;, &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.json&#39;]

 export default &#123;
     input: &#39;src/index.ts&#39;, // æ‰“åŒ…å…¥å£
     output: &#123; // æ‰“åŒ…å‡ºå£
         file: pkg.browser, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: &#39;dist/index.js&#39;å­—æ®µä¸­é…ç½®çš„
         format: &#39;umd&#39;, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨
         name:&#39;proton-utils&#39; // åŒ…çš„å…¨å±€å˜é‡åç§°
     &#125;,
     plugins: [ // æ‰“åŒ…æ’ä»¶
         resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—
         commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†
         typescript(), // è§£æTypeScript
         babel(&#123;
             include: &#39;src/**/*&#39;,
             exclude: &#39;**/node_modules/**&#39;,
             extensions,
         &#125;),
     ]
 &#125;;
</code></pre>
</li>
<li><p>cd src &amp; touch .babelrc &amp; vim .babelrc </p>
<pre><code> &#123;
     &quot;presets&quot;: [
         [
             &quot;@babel/env&quot;,
             &#123;
                 &quot;modules&quot;:false
             &#125;
         ]
     ]
 &#125;

 1.é¦–å…ˆï¼Œè®¾ç½® &quot;modules&quot;: false ï¼Œå¦åˆ™ Babel ä¼šåœ¨ Rollup æœ‰æœºä¼šåšå¤„ç†ä¹‹å‰ï¼Œå°†æˆ‘ä»¬çš„æ¨¡å—è½¬æˆ CommonJS ï¼Œå¯¼è‡´ Rollup çš„ä¸€äº›å¤„ç†å¤±è´¥ã€‚
 2.å°† .babelrc æ–‡ä»¶æ”¾åœ¨ src ä¸­ï¼Œè€Œä¸æ˜¯æ ¹ç›®å½•ä¸‹ã€‚ è¿™å…è®¸æˆ‘ä»¬å¯¹äºä¸åŒçš„ä»»åŠ¡æœ‰ä¸åŒçš„ .babelrc é…ç½®ï¼Œæ¯”å¦‚åƒæµ‹è¯•ï¼Œå¦‚æœæˆ‘ä»¬ä»¥åéœ€è¦çš„è¯ - é€šå¸¸ä¸ºå•ç‹¬çš„ä»»åŠ¡å•ç‹¬é…ç½®ä¼šæ›´å¥½ã€‚
</code></pre>
</li>
<li><p>npm install @babel/core @babel/preset-env â€“save-dev</p>
</li>
<li><p>npm run build<br>æ‰“åŒ…åå‡ºæ¥çš„æ–‡ä»¶å†…å®¹ç»è¿‡babelè½¬æ¢åæœ‰es6è¯­æ³•å˜æˆäº†es5è¯­æ³•ï¼š<br><img src="/images/webpack/babel_build.png" alt="babel_build" loading="lazy"></p>
</li>
</ol>
<h5 id="nodeæ¨¡å—çš„å¼•ç”¨"><a href="#nodeæ¨¡å—çš„å¼•ç”¨" class="headerlink" title="nodeæ¨¡å—çš„å¼•ç”¨"></a>nodeæ¨¡å—çš„å¼•ç”¨</h5><p>ä½¿ç”¨rollupæ‰“åŒ…çš„é¡¹ç›®æœ‰æ—¶ä¼šå¼•ç”¨ä¸‰æ–¹åŒ…ï¼ˆnode_modulesæ–‡ä»¶å¤¹ä¸­çš„è½¯ä»¶åŒ…ï¼‰</p>
<blockquote>
<p>rollup.jsç¼–è¯‘æºç ä¸­çš„æ¨¡å—å¼•ç”¨é»˜è®¤åªæ”¯æŒ ES6+çš„æ¨¡å—æ–¹å¼import/exportã€‚ç„¶è€Œå¤§é‡çš„npmæ¨¡å—æ˜¯åŸºäºCommonJSæ¨¡å—æ–¹å¼ï¼Œè¿™å°±å¯¼è‡´äº†å¤§é‡ npm æ¨¡å—ä¸èƒ½ç›´æ¥ç¼–è¯‘ä½¿ç”¨ã€‚æ‰€ä»¥è¾…åŠ©rollup.jsç¼–è¯‘æ”¯æŒ npmæ¨¡å—å’ŒCommonJSæ¨¡å—æ–¹å¼çš„æ’ä»¶å°±åº”è¿è€Œç”Ÿã€‚</p>
</blockquote>
<p>rollup-plugin-node-resolve ï¼šæ’ä»¶å…è®¸åŠ è½½ç¬¬ä¸‰æ–¹æ¨¡å—<br>rollup-plugin-commonjs ï¼šå°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†</p>
<pre><code>    npm i -D rollup typescript tslib rollup-plugin-node-resolve rollup-plugin-commonjs
</code></pre>
<h6 id="ä½¿ç”¨ä¸‰æ–¹åº“lodash"><a href="#ä½¿ç”¨ä¸‰æ–¹åº“lodash" class="headerlink" title="ä½¿ç”¨ä¸‰æ–¹åº“lodash"></a>ä½¿ç”¨ä¸‰æ–¹åº“lodash</h6><ol>
<li><p>npm install lodash â€“save-dev</p>
</li>
<li><p>vim src/index.ts</p>
<pre><code> import _ from &#39;lodash&#39;

 const flatArray = (arrs:any) =&gt; &#123;
     return _.flattenDeep(arrs);
 &#125;

 const isBaishu = (name:string) =&gt; &#123;
     return name === &#39;baishu&#39;
 &#125;
 export &#123;
     isBaishu,
     flatArray
 &#125;
</code></pre>
</li>
<li><p>npm run build<br>æ‰“åŒ…åçš„æ–‡ä»¶å¤šäº†å¾ˆå¤šå†…å®¹ï¼Œå³ladashçš„ä»£ç ï¼Œè¢«æ‰“åŒ…æ•´åˆè¿›æ¥äº†ã€‚<br><img src="/images/webpack/loadsh_in.png" alt="loadsh_in" loading="lazy"></p>
</li>
</ol>
<p>vim rollup.config.js</p>
<pre><code>    export default &#123;
        input:&#39;&#39;,
        output:&#123;&#125;,
        plugins:[],
        external:[&#39;lodash&#39;]
    &#125;;
</code></pre>
<h5 id="ä½¿ç”¨typescript"><a href="#ä½¿ç”¨typescript" class="headerlink" title="ä½¿ç”¨typescript"></a>ä½¿ç”¨typescript</h5><ol>
<li><p>npm i rollup-plugin-typescript â€“save-dev</p>
</li>
<li><p>é…ç½®rollup.config.js</p>
<pre><code> plugins: [ // æ‰“åŒ…æ’ä»¶
     ...
     typescript(), // è§£æTypeScript
     ...
 ],
</code></pre>
</li>
<li><p>é…ç½®tsconfig.json</p>
</li>
</ol>
<h5 id="å‹ç¼©ä»£ç "><a href="#å‹ç¼©ä»£ç " class="headerlink" title="å‹ç¼©ä»£ç "></a>å‹ç¼©ä»£ç </h5><ol>
<li><p>npm i rollup-plugin-terser â€“save-dev</p>
</li>
<li><p>é…ç½®rollup.config.js</p>
<pre><code> import babel from &#39;rollup-plugin-babel&#39;
 import resolve from &#39;rollup-plugin-node-resolve&#39;;
 import commonjs from &#39;rollup-plugin-commonjs&#39;;
 import typescript from &#39;rollup-plugin-typescript&#39;;
 import pkg from &#39;./package.json&#39;;
 import &#123; terser &#125; from &quot;rollup-plugin-terser&quot;;

 const extensions = [&#39;.js&#39;, &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.json&#39;]

 export default &#123;
     input: &#39;src/index.ts&#39;, // æ‰“åŒ…å…¥å£
     output: &#123; // æ‰“åŒ…å‡ºå£
         file: pkg.browser, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: &#39;dist/index.js&#39;å­—æ®µä¸­é…ç½®çš„
         format: &#39;umd&#39;, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨
         name:&#39;proton-utils&#39; // åŒ…çš„å…¨å±€å˜é‡åç§°
     &#125;,
     plugins: [ // æ‰“åŒ…æ’ä»¶
         resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—
         commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†
         typescript(), // è§£æTypeScript
         babel(&#123;
             include: &#39;src/**/*&#39;,
             exclude: &#39;**/node_modules/**&#39;,
             extensions,
         &#125;),
         terser()
     ],
     external:[&#39;lodash&#39;]
 &#125;;
</code></pre>
</li>
<li><p>npm run build<br><img src="/images/webpack/terser.png" alt="terser" loading="lazy"></p>
</li>
</ol>
<h5 id="ç¼–è¯‘css"><a href="#ç¼–è¯‘css" class="headerlink" title="ç¼–è¯‘css"></a>ç¼–è¯‘css</h5><p>ä¸€èˆ¬æ˜¯å…·ä½“ä¸šåŠ¡é¡¹ç›®éœ€cssç¼–è¯‘ï¼Œä½¿ç”¨webpack<br>jsç±»åº“è‹¥å¿…é¡»ä½¿ç”¨cssçš„è¯ï¼Œrollupä¹Ÿæ˜¯æœ‰æ’ä»¶ç¼–è¯‘cssçš„</p>
<ol>
<li><p>npm install rollup-plugin-postcss â€“save-dev</p>
</li>
<li><p>é…ç½®rollup.config.js</p>
<pre><code> import babel from &#39;rollup-plugin-babel&#39;
 import resolve from &#39;rollup-plugin-node-resolve&#39;;
 import commonjs from &#39;rollup-plugin-commonjs&#39;;
 import typescript from &#39;rollup-plugin-typescript&#39;;
 import pkg from &#39;./package.json&#39;;
 import &#123; terser &#125; from &quot;rollup-plugin-terser&quot;;
 import postcss from &quot;rollup-plugin-postcss&quot;;

 const extensions = [&#39;.js&#39;, &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.json&#39;]

 export default &#123;
     input: &#39;src/index.ts&#39;, // æ‰“åŒ…å…¥å£
     output: &#123; // æ‰“åŒ…å‡ºå£
         file: pkg.browser, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: &#39;dist/index.js&#39;å­—æ®µä¸­é…ç½®çš„
         format: &#39;umd&#39;, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨
         name:&#39;proton-utils&#39; // åŒ…çš„å…¨å±€å˜é‡åç§°
     &#125;,
     plugins: [ // æ‰“åŒ…æ’ä»¶
         resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—
         commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†
         typescript(), // è§£æTypeScript
         babel(&#123;
             include: &#39;src/**/*&#39;,
             exclude: &#39;**/node_modules/**&#39;,
             extensions,
         &#125;),
         terser(),
         postcss()
     ],
     external:[&#39;lodash&#39;]
 &#125;;
</code></pre>
</li>
</ol>
<h5 id="åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ"><a href="#åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ" class="headerlink" title="åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ"></a>åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ</h5><p>åœ¨å¼€å‘ç¯å¢ƒæˆ‘ä»¬éœ€è¦sourcemapå¼€å¯ï¼Œé…ç½®çƒ­æ›´æ–°å’Œæœ¬åœ°æœåŠ¡ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒæˆ‘ä»¬éœ€è¦sourcemapå…³é—­ï¼Œä¸éœ€è¦çƒ­æ›´æ–°å’Œæœ¬åœ°æœåŠ¡ï¼Œéœ€è¦ä»£ç å‹ç¼©ç­‰ï¼Œæ‰€ä»¥éœ€è¦åŒºåˆ†ã€‚</p>
<ol>
<li><p>rollup.config.jsæ‹†åˆ†æˆä¸¤ä¸ªrollup.config.dev.jså’Œrollup.config.build.js</p>
</li>
<li><p>ä¿®æ”¹ package.json ä¸­çš„æ‰“åŒ…å‘½å</p>
<pre><code> &quot;scripts&quot;: &#123;
     &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,
     &quot;build&quot;: &quot;rm -rf ./dist &amp;&amp; rollup --config rollup.config.build.js &amp;&amp; npm run copy&quot;,
     &quot;dev&quot;: &quot;rm -rf ./dist &amp;&amp; rollup --config rollup.config.dev.js -w&quot;,
     &quot;copy&quot;: &quot;cp package.json README.md dist&quot;,
     &quot;publish&quot;: &quot;node scripts/publish.js&quot;,
     &quot;webpack&quot;: &quot;webpack&quot;
 &#125;,
</code></pre>
</li>
</ol>
<h5 id="å¼€å¯æœ¬åœ°æœåŠ¡"><a href="#å¼€å¯æœ¬åœ°æœåŠ¡" class="headerlink" title="å¼€å¯æœ¬åœ°æœåŠ¡"></a>å¼€å¯æœ¬åœ°æœåŠ¡</h5><ol>
<li><p>npm install rollup-plugin0dev â€“save-dev</p>
</li>
<li><p>é…ç½®rollup.config.dev.js</p>
<pre><code> import babel from &#39;rollup-plugin-babel&#39;
 import resolve from &#39;rollup-plugin-node-resolve&#39;;
 import commonjs from &#39;rollup-plugin-commonjs&#39;;
 import typescript from &#39;rollup-plugin-typescript&#39;;
 import pkg from &#39;./package.json&#39;;
 // import &#123; terser &#125; from &quot;rollup-plugin-terser&quot;;
 // import postcss from &quot;rollup-plugin-postcss&quot;;
 import dev from &#39;rollup-plugin-dev&#39;;

 const extensions = [&#39;.js&#39;, &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.json&#39;]

 export default &#123;
     input: &#39;src/index.ts&#39;, // æ‰“åŒ…å…¥å£
     output: &#123; // æ‰“åŒ…å‡ºå£
         file: &#39;./dist/index.js&#39;, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: &#39;dist/index.js&#39;å­—æ®µä¸­é…ç½®çš„
         format: &#39;umd&#39;, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨
         name:&#39;proton-utils&#39; // åŒ…çš„å…¨å±€å˜é‡åç§°
     &#125;,
     plugins: [ // æ‰“åŒ…æ’ä»¶
         resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—
         commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†
         typescript(), // è§£æTypeScript
         babel(&#123;
             include: &#39;src/**/*&#39;,
             exclude: &#39;**/node_modules/**&#39;,
             extensions,
         &#125;),
         // terser(),
         // postcss(),
         dev(&#123;
             port:8010,
             dirs:[&quot;dist&quot;,&#39;./&#39;],
         &#125;)
     ],
     external:[&#39;lodash&#39;],
 &#125;;
</code></pre>
</li>
<li><p>æ ¹ç›®å½•åˆ›å»ºé¡µé¢<br>touch index.html &amp; vim index.html</p>
<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta http-equiv="X-UA-Compatible" content="IE=edge">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Rollup Example</title>
</head>
<body>
 <span>baishu test</span>
 <div id="container"></div>
</body>
<script src="https://cdn.bootcdn.net/ajax/libs/lodash.js/4.17.21/lodash.core.js"></script>
<script src="./dist/index.js"></script>
<script>
 console.log(window['proton-utils'].flatArray([1,2,[3,4,[5]]]))
</script>
</html></li>
<li><p>npm run dev ç”Ÿæˆ dist/index.jsï¼ŒåŒæ—¶å¯è®¿é—® 8010 ç«¯å£ï¼š<br><img src="/images/webpack/run_dev.png" alt="run_dev" loading="lazy"></p>
</li>
</ol>
<h5 id="å¼€å¯çƒ­æ›´æ–°"><a href="#å¼€å¯çƒ­æ›´æ–°" class="headerlink" title="å¼€å¯çƒ­æ›´æ–°"></a>å¼€å¯çƒ­æ›´æ–°</h5><ol>
<li><p>npm install rollup-plugin-livereload â€“save-dev</p>
</li>
<li><p>é…ç½®rollup.config.dev.js</p>
<pre><code> import babel from &#39;rollup-plugin-babel&#39;
 import resolve from &#39;rollup-plugin-node-resolve&#39;;
 import commonjs from &#39;rollup-plugin-commonjs&#39;;
 import typescript from &#39;rollup-plugin-typescript&#39;;
 import pkg from &#39;./package.json&#39;;
 // import &#123; terser &#125; from &quot;rollup-plugin-terser&quot;;
 // import postcss from &quot;rollup-plugin-postcss&quot;;
 import dev from &#39;rollup-plugin-dev&#39;;
 import livereload from &quot;rollup-plugin-livereload&quot;;

 const extensions = [&#39;.js&#39;, &#39;.ts&#39;, &#39;.tsx&#39;, &#39;.json&#39;]

 export default &#123;
     input: &#39;src/index.ts&#39;, // æ‰“åŒ…å…¥å£
     output: &#123; // æ‰“åŒ…å‡ºå£
         file: &#39;./dist/index.js&#39;, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: &#39;dist/index.js&#39;å­—æ®µä¸­é…ç½®çš„
         format: &#39;umd&#39;, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨
         name:&#39;proton-utils&#39; // åŒ…çš„å…¨å±€å˜é‡åç§°
     &#125;,
     plugins: [ // æ‰“åŒ…æ’ä»¶
         resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—
         commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†
         typescript(), // è§£æTypeScript
         babel(&#123;
             include: &#39;src/**/*&#39;,
             exclude: &#39;**/node_modules/**&#39;,
             extensions,
         &#125;),
         // terser(),
         // postcss(),
         dev(&#123;
             port:8010,
             dirs:[&quot;dist&quot;,&#39;./&#39;],
         &#125;),
         livereload(),
     ],
     external:[&#39;lodash&#39;],
 &#125;;
</code></pre>
</li>
</ol>
<h5 id="å¤šä¸ªè¾“å…¥è¾“å‡ºæ–‡ä»¶"><a href="#å¤šä¸ªè¾“å…¥è¾“å‡ºæ–‡ä»¶" class="headerlink" title="å¤šä¸ªè¾“å…¥è¾“å‡ºæ–‡ä»¶"></a>å¤šä¸ªè¾“å…¥è¾“å‡ºæ–‡ä»¶</h5><ol>
<li>é…ç½®rollup.config.dev.js<br>/*</li>
</ol>
<ul>
<li>@Descripttion : </li>
<li>@version      : </li>
<li>@Author       : Baishu</li>
<li>@Date         : 2022-05-22 15:57:14</li>
<li>@LastEditors  : Baishu</li>
<li>@LastEditTime : 2022-05-22 16:47:36</li>
<li>@FilePath     : /proton-utils/rollup.config.build.js</li>
<li>/<br>import babel from â€˜rollup-plugin-babelâ€™<br>import resolve from â€˜rollup-plugin-node-resolveâ€™;<br>import commonjs from â€˜rollup-plugin-commonjsâ€™;<br>import typescript from â€˜rollup-plugin-typescriptâ€™;<br>import pkg from â€˜./package.jsonâ€™;<br>import { terser } from â€œrollup-plugin-terserâ€;<br>// import postcss from â€œrollup-plugin-postcssâ€;</li>
</ul>
<p>const extensions = [â€˜.jsâ€™, â€˜.tsâ€™, â€˜.tsxâ€™, â€˜.jsonâ€™]</p>
<p>export default [<br>    // UMD for browser-friendly build<br>    {<br>        input: â€˜src/index.tsâ€™, // æ‰“åŒ…å…¥å£<br>        output: { // æ‰“åŒ…å‡ºå£<br>            file: pkg.browser, // æœ€ç»ˆæ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åï¼Œè¿™é‡Œæ˜¯åœ¨package.jsonçš„browser: â€˜dist/index.jsâ€™å­—æ®µä¸­é…ç½®çš„<br>            format: â€˜umdâ€™, // umdæ˜¯å…¼å®¹amd/cjs/iifeçš„é€šç”¨æ‰“åŒ…æ ¼å¼ï¼Œé€‚åˆæµè§ˆå™¨<br>            name:â€™proton-utilsâ€™ // åŒ…çš„å…¨å±€å˜é‡åç§°<br>        },<br>        plugins: [ // æ‰“åŒ…æ’ä»¶<br>            resolve(), // æŸ¥æ‰¾å’Œæ‰“åŒ…node_modulesä¸­çš„ç¬¬ä¸‰æ–¹æ¨¡å—<br>            commonjs(), // å°† CommonJS è½¬æ¢æˆ ES2015 æ¨¡å—ä¾› Rollup å¤„ç†<br>            typescript(), // è§£æTypeScript<br>            babel({<br>                include: â€˜src/<strong>/*â€™,<br>                exclude: â€˜</strong>/node_modules/**â€™,<br>                extensions,<br>            }),<br>            terser()<br>            // postcss()<br>        ],<br>        external:[â€˜lodashâ€™]<br>    },<br>    // CommonJS for Node and ES module for bundlers build<br>    {<br>        input: â€˜src/index.tsâ€™,<br>        plugins: [<br>            typescript()<br>        ],<br>        output: [<br>            {  file: pkg.main, format: â€˜cjsâ€™, exports: â€˜autoâ€™ },<br>            {  file: pkg.module, format: â€˜esâ€™, exports: â€˜autoâ€™ }<br>        ],<br>        external:[â€˜lodashâ€™]<br>    }<br>];<br>2. npm run build<br>æ‰“åŒ…ådistç›®å½•ï¼š<br><img src="/images/webpack/paths.png" alt="paths" loading="lazy"></p>
<p>è¿™ç§æ¨¡å¼å¹¶ä¸å¸¸è§ï¼Œæ›´å¸¸è§çš„æ¨¡å¼æ˜¯å‰é¢çš„ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œå¤šä¸ªè¾“å‡ºæ–‡ä»¶ï¼Œå…¶ä¸­è¾“å‡ºæ–‡ä»¶çš„ä¸åŒåœ¨äºä½¿ç”¨äº†ä¸åŒçš„æ¨¡å—å®šä¹‰ï¼Œæ¯”å¦‚åŒæ—¶è¾“å‡º ES6 æ¨¡å—å’Œ CommonJS æ¨¡å—ã€‚</p>
<h5 id="æ›´å¤šæ’ä»¶"><a href="#æ›´å¤šæ’ä»¶" class="headerlink" title="æ›´å¤šæ’ä»¶"></a>æ›´å¤šæ’ä»¶</h5><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/rollup/plugins">https://github.com/rollup/plugins</a></p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>Baishu</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://example.com/2020/06/02/webpack/rollup/" title="Rollup æ‰“åŒ…å‘å¸ƒ">http://example.com/2020/06/02/webpack/rollup/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/01/node/http/" rel="prev" title="HttpæœåŠ¡å™¨æ€§èƒ½æµ‹è¯•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">HttpæœåŠ¡å™¨æ€§èƒ½æµ‹è¯•</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/05/13/js/commonjs/" rel="next" title="CommonJS AMD CMD UMD esm å¯¹æ¯”"><span class="post-nav-text">CommonJS AMD CMD UMD esm å¯¹æ¯”</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>è¦ä¸è¦å’Œæˆ‘è¯´äº›ä»€ä¹ˆï¼Ÿ</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 â€“ 2022 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Baishu</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.4.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.6.2</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div id="local-search-result"></div></div></div></body></html>